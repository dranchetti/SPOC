{"name":"SPOC - SharePoint Online Connector (Beta)","tagline":"A Javascript library that simplifies working with the SharePoint and Yammer REST APIs from within Office 365","body":"# SPOC - SharePoint Online Connector.\r\n\r\nSPOC is a client-side Javascript library that helps you interact with the **SharePoint Online & Yammer REST APIs**. It also contains handy helper and utility functions that are regularly used when working on Front-end SharePoint projects. \r\n\r\nThe library currently lets you interact with:  \r\n\r\n  - SharePoint Sites (Both App and Host Webs)\r\n  - SharePoint Lists\r\n  - SharePoint List Items\r\n  - SharePoint User Profiles\r\n  - SharePoint Search\r\n  - Delve Boards\r\n  - Files (Upload, Download, Open, Generate timed guest links)\r\n  - Yammer Search \r\n  - Yammer Posts & Feeds\r\n  - Yammer Profiles\r\n\r\n#### SharePoint Hosted App Model\r\nSPOC has built in logic that automatically detects when you are trying to call a site within a different domain and handles the relevant calls. This makes it really simple to interact with both the Host and App web when using the library within a SharePoint Hosted App.\r\n\r\n## Getting Started\r\nFirst download  **SPOC.min.js** and include it in your project or add it to your master-page or page layouts. Note that **If you want to interact with Yammer from within SharePoint Online, you must also include the Yammer JS SDK** by adding the following into your master-page or page layouts.\r\n\r\n```html \r\n<!-- Optional - only needed if you are using Yammer functions -->\r\n<script type=\"text/javascript\" data-app-id=\"ADD YAMMER APP ID\" src=\"https://c64.assets-yammer.com/assets/platform_js_sdk.js\"></script>\r\n\r\n<!-- Load SPOC library into your masterpage or pagelayout -->\r\n<script type=\"text/javascript\" src=\"https://yoursite.sharepoint.com/document_library/SPOC.min.js\"></script>\r\n\r\n```\r\n\r\n> To use the Yammer API, you must first register an app on your network and set the app-id shown above. You can find out how to do this by visiting the [Yammer help pages](https://developer.yammer.com/docs/app-registration)\r\n\r\n\r\n## Basic Examples\r\n##### 1. Get items from a SharePoint list\r\nThis examples show you how to retrieve items from a SharePoint list. The list item method allows you to pass in filters and query settings via a JS object. It supports all default OData query string operators (select, filter, orderBy, expand, top etc). More information can be found on [MSDN](https://msdn.microsoft.com/en-us/library/office/fp142385.aspx#sectionSection0).\r\n\r\n```javascript\r\n// Create a new site instance. Passing no url with set it as the current site\r\nvar site = new SPOC.SP.Site();\r\n\r\n// Create an object with your required settings\r\n    var settings = {\r\n        select: \"Title,Created\",\r\n        filter: \"Title eq 'My Item Title'\",\r\n        orderBy: 'Created'\r\n    };\r\n\r\n// Pass in the name of the list that you would like to query \r\nvar exampleList = site.listItems('List Name');\r\n\r\n// Query list, passing in your settings. If you don't pass anything into the query, it will return all items.\r\nexampleList.query(settings).then(function(results){\r\n    console.log(results);\r\n});\r\n\r\n```\r\n> Note that all GET requests automatically cache results in the browser sessionStorage. If you would like to bypass the cache, pass true into the second parameter of the query function.\r\n\r\n##### 2. Retrieve items from both the Host and App web from within a SharePoint Hosted App\r\nThis example shows how interacting with the host or app web when using SPOC in a SharePoint Hosted App is really simple.\r\n```javascript\r\n// Create a new site instance both the host and app web. To create the app web, leave the site param empty. To create the host web, pass your host web url into the site param.\r\nvar hostWeb = new SPOC.SP.Site('https://example.sharepoint.com/sites/mysite');\r\nvar appWeb = new SPOC.SP.Site();\r\n\r\n// Both the host and app web instances can be called as normal. The hostWeb call will automatically use the SP xdomain logic.\r\nhostWeb.listItems('Host web List Name').query().then(function(data){\r\n    console.log(data)\r\n});\r\n\r\nappWeb.listItems('App Web List Name').query().then(function(data){\r\n    console.log(data)\r\n});\r\n\r\n```\r\n\r\nNote that when using SPOC, or calling the SharePoint API, from a App web, you should ensure the following scripts are added to your page.\r\n\r\n```html\r\n    <script type=\"text/javascript\" src=\"/_layouts/15/MicrosoftAjax.js\"></script>\r\n    <script type=\"text/javascript\" src=\"/_layouts/15/sp.runtime.js\"></script>\r\n    <script type=\"text/javascript\" src=\"/_layouts/15/sp.js\"></script>\r\n```\r\n\r\n##### 3. Get the current users profile details\r\nThis examples shows how to get the current users profile properties\r\n\r\n```javascript\r\n// Create a new user instance.\r\nvar user = new SPOC.SP.User();\r\n\r\n// Query the users profile\r\nuser.Profile().query().then(function(results){\r\n    console.log(results);\r\n});\r\n\r\n```\r\n\r\n##### 4. Get personalised yammer posts for the logged in user (Posts from People, Groups and topics that they follow)\r\nThis examples shows how to get Yammer posts from People, Groups and Topics that hte current user is following \r\n```javascript\r\n// Create a new Yammer Messages instance.\r\nvar feed = new SPOC.Yam.Feed();\r\n\r\nvar posts = feed.posts();\r\n\r\nposts.query().then(function(data){\r\n    console.log(data);\r\n    // outputs a object array of Yammer posts\r\n});\r\n\r\n## More Examples\r\nView the [more examples page](https://github.com/wearearchitect/SPOC/blob/master/docs/examples.md) to see a full list of functionilty avaialable within SPOC.\r\n\r\n## Utility functions and Helpers\r\nSPOC includes utility functions functions that are useful when developing within SharePoint. You can view a [list of utility functions here] (https://github.com/wearearchitect/SPOC/blob/master/docs/utils.md).\r\n\r\n## Mock API calls (Developing outside of SP)\r\nTo help improve efficiency when working on front-end based SharePoint projects, we often start development offline (i.e creating the styling, HTML templates etc), and then integrate it to SharePoint once completed. This makes the development process much quicker. \r\n\r\nThe problem with this is that you do not have access to the SharePoint API's when working offline. In order to get around this, SPOC includes the ability to create fake lists & users using javascript or a JSON file. The Library will then return the fake lists / list items / users when running outside of SharePoint! As soon as you run the file inside of SharePoint, it will return to using the real list apis. When using this feature, be sure to create a mock list for each real list within your solution.\r\n\r\n```javascript\r\n\r\n// Create items to add to the mock list \r\nvar myListItems = [{Title: \"Item One\",Title: \"Item Two\", Title: \"Item Three\"}];\r\n\r\n// Create a mock list called 'MyList' and list items\r\nSPOC.Mock.createList('MyList', myListItems);\r\n\r\n// Query SharePoint list as normal\r\n\r\nvar site = new SPOC.SP.Site();\r\nvar exampleList = site.listItems('MyList');\r\n\r\nexampleList.query().then(function(results){\r\n    console.log(results);\r\n    // Returns [{Title: \"Item One\",Title: \"Item Two\", Title: \"Item Three\"}]\r\n});\r\n\r\n```\r\n\r\n## Contributing\r\nPlease read the [contributing.md](https://github.com/wearearchitect/SPOC/blob/master/docs/contributing.md) to find out how you can get involved in the project.\r\n\r\n## Versions\r\n0.0.1 - Bewared - still in early development stage\r\n\r\n## License\r\n----\r\nThe code and the documentation are released under the [MIT License](https://github.com/wearearchitect/SPOC/blob/master/LICENSE)\r\n\r\n**Free Software, Hell Yeah!**\r\n\r\n","google":"UA-72429814-1","note":"Don't delete this file! It's used internally to help with page regeneration."}