/*! SPOC 04-02-2016 */
(function(){"use strict";function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function b(a){return"function"==typeof a}function c(a){return"object"==typeof a&&null!==a}function d(a){P=a}function e(a){T=a}function f(){return function(){process.nextTick(k)}}function g(){return function(){O(k)}}function h(){var a=0,b=new W(k),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function i(){var a=new MessageChannel;return a.port1.onmessage=k,function(){a.port2.postMessage(0)}}function j(){return function(){setTimeout(k,1)}}function k(){for(var a=0;S>a;a+=2){var b=Z[a],c=Z[a+1];b(c),Z[a]=void 0,Z[a+1]=void 0}S=0}function l(){try{var a=require,b=a("vertx");return O=b.runOnLoop||b.runOnContext,g()}catch(c){return j()}}function m(){}function n(){return new TypeError("You cannot resolve a promise with itself")}function o(){return new TypeError("A promises callback cannot return that same promise.")}function p(a){try{return a.then}catch(b){return ba.error=b,ba}}function q(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function r(a,b,c){T(function(a){var d=!1,e=q(c,b,function(c){d||(d=!0,b!==c?u(a,c):w(a,c))},function(b){d||(d=!0,x(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,x(a,e))},a)}function s(a,b){b._state===_?w(a,b._result):b._state===aa?x(a,b._result):y(b,void 0,function(b){u(a,b)},function(b){x(a,b)})}function t(a,c){if(c.constructor===a.constructor)s(a,c);else{var d=p(c);d===ba?x(a,ba.error):void 0===d?w(a,c):b(d)?r(a,c,d):w(a,c)}}function u(b,c){b===c?x(b,n()):a(c)?t(b,c):w(b,c)}function v(a){a._onerror&&a._onerror(a._result),z(a)}function w(a,b){a._state===$&&(a._result=b,a._state=_,0!==a._subscribers.length&&T(z,a))}function x(a,b){a._state===$&&(a._state=aa,a._result=b,T(v,a))}function y(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+_]=c,e[f+aa]=d,0===f&&a._state&&T(z,a)}function z(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?C(c,d,e,f):e(f);a._subscribers.length=0}}function A(){this.error=null}function B(a,b){try{return a(b)}catch(c){return ca.error=c,ca}}function C(a,c,d,e){var f,g,h,i,j=b(d);if(j){if(f=B(d,e),f===ca?(i=!0,g=f.error,f=null):h=!0,c===f)return void x(c,o())}else f=e,h=!0;c._state!==$||(j&&h?u(c,f):i?x(c,g):a===_?w(c,f):a===aa&&x(c,f))}function D(a,b){try{b(function(b){u(a,b)},function(b){x(a,b)})}catch(c){x(a,c)}}function E(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(m),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?w(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&w(c.promise,c._result))):x(c.promise,c._validationError())}function F(a){return new da(this,a).promise}function G(a){function b(a){u(e,a)}function c(a){x(e,a)}var d=this,e=new d(m);if(!R(a))return x(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===$&&f>g;g++)y(d.resolve(a[g]),void 0,b,c);return e}function H(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(m);return u(c,a),c}function I(a){var b=this,c=new b(m);return x(c,a),c}function J(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function K(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(a){this._id=ia++,this._state=void 0,this._result=void 0,this._subscribers=[],m!==a&&(b(a)||J(),this instanceof L||K(),D(this,a))}function M(){var a;if("undefined"!=typeof global)a=global;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)&&(a.Promise=ja)}var N;N=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var O,P,Q,R=N,S=0,T=({}.toString,function(a,b){Z[S]=a,Z[S+1]=b,S+=2,2===S&&(P?P(k):Q())}),U="undefined"!=typeof window?window:void 0,V=U||{},W=V.MutationObserver||V.WebKitMutationObserver,X="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3);Q=X?f():W?h():Y?i():void 0===U&&"function"==typeof require?l():j();var $=void 0,_=1,aa=2,ba=new A,ca=new A;E.prototype._validateInput=function(a){return R(a)},E.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},E.prototype._init=function(){this._result=new Array(this.length)};var da=E;E.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===$&&b>e;e++)a._eachEntry(d[e],e)},E.prototype._eachEntry=function(a,b){var d=this,e=d._instanceConstructor;c(a)?a.constructor===e&&a._state!==$?(a._onerror=null,d._settledAt(a._state,b,a._result)):d._willSettleAt(e.resolve(a),b):(d._remaining--,d._result[b]=a)},E.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===$&&(d._remaining--,a===aa?x(e,c):d._result[b]=c),0===d._remaining&&w(e,d._result)},E.prototype._willSettleAt=function(a,b){var c=this;y(a,void 0,function(a){c._settledAt(_,b,a)},function(a){c._settledAt(aa,b,a)})};var ea=F,fa=G,ga=H,ha=I,ia=0,ja=L;L.all=ea,L.race=fa,L.resolve=ga,L.reject=ha,L._setScheduler=d,L._setAsap=e,L._asap=T,L.prototype={constructor:L,then:function(a,b){var c=this,d=c._state;if(d===_&&!a||d===aa&&!b)return this;var e=new this.constructor(m),f=c._result;if(d){var g=arguments[d-1];T(function(){C(d,e,g,f)})}else y(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var ka=M,la={Promise:ja,polyfill:ka};"function"==typeof define&&define.amd?define(function(){return la}):"undefined"!=typeof module&&module.exports?module.exports=la:"undefined"!=typeof this&&(this.ES6Promise=la),ka()}).call(this),function(a,b,c,d){"use strict";a.Promise=Promise?Promise:RSVP.Promise,c.Utils={},c.SP={},c.Yam={},c.Utils.Conversion={},c.Utils.Conversion.objToQueryString=function(a){var b="";for(var c in a)b+="&$"+c+"="+a[c].replace(/ /g,"_x0020_");return encodeURI(b)},c.Mock={active:b.getElementById("s4-workspace")?!1:!0,db:{}},a._spPageContextInfo||(a._spPageContextInfo={userId:1,userLoginName:"test",webAbsoluteUrl:"local"}),c.Mock.dummyText=function(a,b,c){var d=new Array("lorem","ipsum","dolor","sit","amet,","consectetur","adipisicing","elit,","sed","do","eiusmod","tempor","incididunt","ut","labore","et","dolore","magna","aliqua.","enim","ad","minim","veniam,","quis","nostrud","exercitation","ullamco","laboris","nisi","ut","aliquip","ex","ea","commodo","consequat.","duis","aute","irure","dolor","in","reprehenderit","in","voluptate","velit","esse","cillum","dolore","eu","fugiat","nulla","pariatur.","excepteur","sint","occaecat","cupidatat","non","proident,","sunt","in","culpa","qui","officia","deserunt","mollit","anim","id","est","laborum.","sed","ut","perspiciatis,","unde","omnis","iste","natus","error","sit","voluptatem","accusantium","doloremque","laudantium,","totam","rem","aperiam","eaque","ipsa,","quae","ab","illo","inventore","veritatis","et","quasi","architecto","beatae","vitae","dicta","sunt,","explicabo.","nemo","enim","ipsam","voluptatem,","quia","voluptas","sit,","aspernatur","aut","odit","aut","fugit,","sed","quia","consequuntur","magni","dolores","eos,","qui","ratione","voluptatem","sequi","nesciunt,","neque","porro","quisquam","est,","qui","dolorem","ipsum,","quia","dolor","sit,","amet,","consectetur,","adipisci","velit,","sed","quia","non","numquam","eius","modi","tempora","incidunt,","ut","labore","et","dolore","magnam","aliquam","quaerat","voluptatem.","ut","enim","ad","minima","veniam,","quis","nostrum","exercitationem","ullam","corporis","suscipit","laboriosam,","nisi","ut","aliquid","ex","ea","commodi","consequatur?","quis","autem","vel","eum","iure","reprehenderit,","qui","in","ea","voluptate","velit","esse,","quam","nihil","molestiae","consequatur,","vel","illum,","qui","dolorem","eum","fugiat,","quo","voluptas","nulla","pariatur?","at","vero","eos","et","accusamus","et","iusto","odio","dignissimos","ducimus,","qui","blanditiis","praesentium","voluptatum","deleniti","atque","corrupti,","quos","dolores","et","quas","molestias","excepturi","sint,","obcaecati","cupiditate","non","provident,","similique","sunt","in","culpa,","qui","officia","deserunt","mollitia","animi,","id","est","laborum","et","dolorum","fuga.","harum","quidem","rerum","facilis","est","et","expedita","distinctio.","Nam","libero","tempore,","cum","soluta","nobis","est","eligendi","optio,","cumque","nihil","impedit,","quo","minus","id,","quod","maxime","placeat,","facere","possimus,","omnis","voluptas","assumenda","est,","omnis","dolor","repellendus.","temporibus","autem","quibusdam","aut","officiis","debitis","aut","rerum","necessitatibus","saepe","eveniet,","ut","et","voluptates","repudiandae","sint","molestiae","non","recusandae.","itaque","earum","rerum","hic","tenetur","a","sapiente","delectus,","aut","reiciendis","voluptatibus","maiores","alias","consequatur","aut","perferendis","doloribus","asperiores","repellat"),e=["docx","jpeg","pptx","xlsx","pdf","mp4","txt"],f=b?e[Math.floor(Math.random()*e.length)]:"",g="",h="",i="";c=c?c:" ";for(var j=0;a>j;j++)i=d[Math.floor(Math.random()*(d.length-1))],("."==h.substring(h.length-1,h.length)||"?"==h.substring(h.length-1,h.length))&&(i=i.substring(0,1).toUpperCase()+i.substring(1,i.length)),h+=c+i;return b&&(h=h.replace(/,/g,"")),g=h.substring(1,h.length-1)+"."+f,g.charAt(0).toUpperCase()+g.slice(1)},c.Mock.dummyImage=function(a,b,c){return a=a?a:600,b=b?b:400,"http://lorempixel.com/"+a+"/"+b+"/"+(c?c:"")},c.Mock.createList=function(a,b){c.Mock.db[a.toLowerCase()]=b},c.Utils.Objects={},c.Utils.Objects.findObjectByProperty=function(a,b,c){var d;for(d=0;d<a.length;d++)if(a[d][b]===c)return a[d];return!1},c.Utils.Objects.merge=function(a,b){for(var c in b)try{b[c].constructor==Object?a[c]=MergeRecursive(a[c],b[c]):a[c]=b[c]}catch(d){a[c]=b[c]}return a},c.Utils.Request={},c.Utils.Request.get=function(a,b){return new Promise(function(d,e){var f=c.Utils.Storage.get("SPOC-"+a);if(f&&!b)d(f);else if(c.Mock&&c.Mock.active){a=c.Utils.Url.getListNameFromUrl(a);var g=c.Mock.db[a];g?d(g):e({error:"no mock data found for the list - "+a})}else{!c.Utils.Url.isSameDomain(a)&&a.toLowerCase().indexOf("_api/web")>-1&&(a=c.Utils.Url.convertToXDomain(a));var h=new XMLHttpRequest;h.open("GET",a,!0),h.setRequestHeader("Accept","application/json;odata=verbose"),h.onreadystatechange=function(){if(4==h.readyState)if(200==h.status){var b=JSON.parse(h.responseText);b=b.d.results?b.d.results:b.d,c.Utils.Storage.set("SPOC-"+a,b),d(b)}else e(Error(JSON.parse(h.statusText)))},h.onerror=function(a){e(Error("Network Error"))},h.send()}})},c.Utils.Request.post=function(a,d,e){return new Promise(function(f,g){if(c.Mock&&c.Mock.active)a=c.Utils.Url.getListNameFromUrl(a),c.Mock.db[a]=d,f(d);else{!c.Utils.Url.isSameDomain(a)&&a.toLowerCase().indexOf("_api/web")>-1&&(a=c.Utils.Url.convertToXDomain(a));var h=new XMLHttpRequest;h.open("POST",a,!0),h.setRequestHeader("Accept","application/json;odata=verbose"),h.setRequestHeader("X-RequestDigest",b.getElementById("__REQUESTDIGEST").value),h.setRequestHeader("Content-Type","application/json;odata=verbose"),e&&h.setRequestHeader("content-length",d.byteLength),h.onreadystatechange=function(){4==h.readyState&&(200==h.status?f(d):g(Error(h.statusText)))},h.onerror=function(a){g(Error("Network Error"))},h.send(e?d:JSON.stringify(d))}})},c.Utils.Request.put=function(a,d){return new Promise(function(e,f){if(c.Mock&&c.Mock.active){a=c.Utils.Url.getListNameFromUrl(a);var g=c.Mock.db[a];g?(c.Mock.db[a]=d,e(d)):f({error:"no mock data found for the list - "+a})}else{!c.Utils.Url.isSameDomain(a)&&a.toLowerCase().indexOf("_api/web")>-1&&(a=c.Utils.Url.convertToXDomain(a));var h=new XMLHttpRequest;h.open("POST",a,!0),h.setRequestHeader("Accept","application/json;odata=verbose"),h.setRequestHeader("X-RequestDigest",b.getElementById("__REQUESTDIGEST").value),h.setRequestHeader("Content-Type","application/json;odata=verbose"),h.setRequestHeader("X-HTTP-Method","MERGE"),h.setRequestHeader("If-Match","*"),h.onreadystatechange=function(){4==h.readyState&&(200==h.status?e(d):f(Error(h.statusText)))},h.onerror=function(a){f(Error("Network Error"))},h.send(JSON.stringify(d))}})},c.Utils.Request.loadScript=function(a,c,d){new Promise(function(c,d){var e=b.createElement("script");e.src=a,e.addEventListener("load",function(){c(a)},!1),e.addEventListener("error",function(){d(a)},!1),b.body.appendChild(e)})},c.Utils.SP={},c.Utils.SP.getListItemType=function(a){return a=a[0].toUpperCase()+a.substring(1),"SP.Data."+a.replace(/ /g,"_x0020_")+"ListItem"},c.Utils.SP.isAppWeb=function(){return a.location.href.toLowerCase().indexOf("sphosturl")>-1?!0:!1},c.Utils.SP.convertToWebApp=function(a){if(a.toLowerCase().indexOf("WopiFrame.aspx")>-1)return a;var b=c.Utils.Strings.getFileExtension(a);return"docx"===b||"pptx"===b||"xlsx"===b?site.url+"/_layouts/15/WopiFrame.aspx?sourcedoc="+a:a},c.Utils.SP.formatSearchResponse=function(a){var b,c,d,e,f=a.query.PrimaryQueryResult.RelevantResults.Table.Rows,g=[];for(f=f.results?f.results:[f],d=0;d<f.length;d++){for(b=f[d].Cells.results,c={},e=0;e<b.length;e++)c[b[e].Key]=b[e].Value;g.push(c)}return g},c.Utils.Storage={},c.Utils.Storage.storageAvailable=function(){return"undefined"!=typeof Storage},c.Utils.Storage.set=function(a,b,d){if(c.Utils.Storage.storageAvailable()){var e=d?localStorage:sessionStorage;e.setItem(a,b===Object(b)?JSON.stringify(b):b)}},c.Utils.Storage.get=function(a,b){if(c.Utils.Storage.storageAvailable()){var d=b?localStorage:sessionStorage;return JSON.parse(d.getItem(a))}return null},c.Utils.Storage.remove=function(a,b){if(c.Utils.Storage.storageAvailable()){b?localStorage:sessionStorage;localStorage.removeItem(a)}},c.Utils.Storage.getCookie=function(a){a+="=";for(var c=b.cookie.split(";"),d=0;d<c.length;d++){var e=c[d].trim();if(0===e.indexOf(a))return e.substring(a.length,e.length)}return!1},c.Utils.Storage.setCookies=function(a,c,d){var e;if(d){var f=new Date;f.setTime(f.getTime()+24*d*60*60*1e3),e="; expires="+f.toGMTString()}else e="";b.cookie=a+"="+c+"; "+e},c.Utils.Storage.removeCookies=function(a){c.Utils.Storage.setCookies(a,"",-1)},c.Utils.Strings={},c.Utils.Strings.cut=function(a,b){return a.length>b?title.substr(0,b-3)+"...":a.length},c.Utils.Strings.getFileExtension=function(a){return a.split(".").pop()},c.Utils.Tpl={},c.Utils.Tpl.getProperty=function(a,b){var c,d=a.split("."),e=d.length,f=b||this;for(c=0;e>c;c++)f=f[d[c]];return f},c.Utils.Tpl.render=function(a,b){var d=/{{(.*?)}}/g,e=a.match(d);if(e&&e.length)for(var f=0,g=e.length;g>f;f++)a=a.replace(new RegExp(e[f],"g"),c.Utils.Tpl.getProperty(e[f].replace(/{{|}}/g,""),b));return a},c.Utils.Url={},c.Utils.Url.getQueryString=function(b,c){c=c?c.split("?")[1]:a.location.search.substring(1);for(var d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]==b)return unescape(f[1])}},c.Utils.Url.getListNameFromUrl=function(a){var b=/\%27(.*)\%27/g,c=b.exec(a);return c?c[1]:null},c.Utils.Url.isSameDomain=function(b){var c=a.location.origin.toLowerCase();return b.toLowerCase().indexOf(c)>-1?!0:!1},c.Utils.Url.convertToXDomain=function(b){b=b.toLowerCase(),b=b.replace("/_api/","/_api/SP.AppContextSite(@target)/");var c=b.split("/_api")[0];return b=b.split("/_api")[1],-1===b.indexOf("?")&&(b+="?"),b=a.location.origin+"/_api"+b+"@target=%27"+c+"%27"},c.Utils.Yammer={},c.Utils.Yammer.formatFeedResponse=function(a){var b,d=[];for(b=0;b<a.messages.length;b++)a.messages[b].replied_to_id||a.messages[b].sender_type&&"user"===a.messages[b].sender_type&&(a.messages[b].user=c.Utils.Arrays.findByProperty(a.references,"id",a.messages[b].sender_id),d.push(a.messages[b]));return d},c.Utils.Yammer.formatSearchResponse=function(a){var b;if(a.messages&&a.messages.messages)for(b=0;b<a.messages.messages.length;b++){var d=a.messages.messages[b];d.sender_type&&"user"===d.sender_type&&(d.user=c.Utils.Arrays.findByProperty(a.messages.references,"id",d.sender_id))}return a},c.Utils.Yammer.checkLogin=function(a){return new Promise(function(b,c){yam.getLoginStatus(function(c){c.authResponse?deferred.resolve(c):a?yam.platform.login(function(a){b(a?a:!1)}):b(c)})})},c.SP.Site=function(b){this.url=b?b:a._spPageContextInfo.webAbsoluteUrl},c.SP.User=function(b){this.id=b?b:a._spPageContextInfo.userId,this.loginName=b?b:a._spPageContextInfo.userLoginName},c.Yam.User=function(b){a.yam||console.log("Please ensure that you have included Yammer SDK and added a valid Client Id"),this.id=b?b:"current"},c.Yam.Feed=function(b,c){a.yam||console.log("Please ensure that you have included Yammer SDK and added a valid Client Id"),this.feedId=b,this.feedType=c},c.SP.Site.prototype.Delve=function(a){var b=this,d={};return d.board=function(d,e,f){return new Promise(function(g,h){var i,j;d||(d="*"),a?(i=b.url+"/_api/search/query?Querytext=%27WorkEmail:"+a+"%27&SelectProperties=%27UserName,DocId%27",c.Utils.Request.get(i,f).then(function(a){a=c.Utils.SP.formatSearchResponse(a),a.length?(a.length>1&&(a=a[0]),j=a.DocId,i=b.url+"/_api/search/query?Querytext='"+d+"'&amp;Properties='GraphQuery:ACTOR("+j+e?", "+e:")",c.Utils.Request.get(i,f).then(function(a){a=c.Utils.SP.formatSearchResponse(a),g(a)},function(a){h(a)})):g(null)},function(a){h(a)})):(i=b.url+"/_api/search/query?Querytext='"+d+"'&amp;Properties='GraphQuery:ACTOR(ME"+e?", "+e:")",c.Utils.Request.get(i,f).then(function(a){a=c.Utils.SP.formatSearchResponse(a),g(a)},function(a){h(a)}))})},d},c.SP.Site.prototype.Files=function(b){var d=this,e={};return"/"!==b.charAt(0)&&(b="/"+b),e.generateExternalLink=function(a){a=a?a:24;var e=d.url+"/_api/Web/GetFileByServerRelativeUrl('"+b+"')/GetPreAuthorizedAccessUrl("+a+")";return c.Utils.Request.get(e,!0)},e.uploadViaModal=function(a){return new Promise(function(b,c){var e={};e.url=d.url+"/_layouts/Upload.aspx?List="+a+"&IsDlg=1",e.dialogReturnValueCallback=Function.createDelegate(null,function(a,c){b(c)}),SP.UI.ModalDialog.showModalDialog(e)})},e.upload=function(a){return new Promise(function(e,f){var g=new FileReader;g.onloadend=function(g){var h=a.value.split("\\"),i=h[h.length-1],j=d.url+"/_api/Web/GetFolderByServerRelativeUrl('"+b+"')/files/add(overwrite=true, url='"+i+"')";c.Utils.Request.post(j,g.target.result,!0).then(function(a){e(a)},function(a){f(a)})},g.onerror=function(a){f(a.target.error)},g.readAsArrayBuffer(a.files[0])})},e.query=function(a){var e=d.url+"/_api/web/getfilebyserverrelativeurl('"+b+"')/ListItemAllFields";return c.Utils.Request.get(e,a)},e.download=function(){a.open("/_layouts/download.aspx?SourceUrl="+d.url+b)},e.openInWebApps=function(e){var f=d.url+b;e?a.open(c.Utils.SP.convertToWebApp(f)):a.location.href=c.Utils.SP.convertToWebApp(f)},e},c.SP.Site.prototype.ListItems=function(a){var b=this,d={};return d.query=function(d,e,f){var g=b.url+"/_api/web/lists/getByTitle%28%27"+a+"%27%29/items";return g+=d?"?"+c.Utils.Conversion.objToQueryString(d):"",c.Utils.Request.get(g,e)},d.create=function(d){var e=b.url+"/_api/web/lists/getByTitle%28%27"+a+"%27%29/items",f={__metadata:{type:c.Utils.SP.getListItemType(a)}};return d&&(f=c.Utils.Objects.merge(f,d)),c.Utils.Request.post(e,f)},d.update=function(d,e){var f=b.url+"/_api/web/lists/getByTitle%28%27"+a+"%27%29/items("+d+")",g={__metadata:{type:c.Utils.SP.getListItemType(a)}};return e&&(g=c.Utils.Objects.merge(g,e)),c.Utils.Request.put(f,g)},d},c.SP.Site.prototype.Lists=function(a){var b=this,d={};return d.query=function(d,e){var f=b.url+"/_api/web/lists/getByTitle%28%27"+a+"%27%29/";return f+=d?"?"+c.Utils.Conversion.objToQueryString(d):"",c.Utils.Request.get(f,e)},d.create=function(a){var d={__metadata:{type:"SP.List"},BaseTemplate:100,Description:""};a&&(d=c.Utils.Objects.merge(d,a));var e=b.url+"/_api/web/lists";return c.Utils.Request.post(e,d)},d},c.SP.Site.prototype.Search=function(a){var b=this,d={};return d.query=function(d,e){return new Promise(function(f,g){var h=b.url+"/_api/search/query?querytext=%27"+a+" +path:"+b.url+"%27";h+=d?"?"+c.Utils.Conversion.objToQueryString(d):"",c.Utils.Request.get(h,e).then(function(a){a=c.Utils.SP.formatSearchResponse(a),f(a)},function(a){g(a)})})},d},c.SP.User.prototype.Profile=function(){var b=this,d={},e="i:0%23.f|membership|";return d.query=function(d){var f=a._spPageContextInfo.webAbsoluteUrl;return f+=b.loginName?"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v=%27"+e+b.loginName+"%27":"/_api/SP.UserProfiles.PeopleManager/GetMyProperties/UserProfileProperties",c.Utils.Request.get(f,d)},d.isMemberOfGroup=function(b,d,e){var f=d?d:a._spPageContextInfo.userId,g=site.url+"/_api/web/sitegroups/getByName('"+b+"')/Users?$filter=Id eq "+f;return c.Utils.Request.get(g,e)},d},c.Yam.Feed.prototype.posts=function(){var a=this,b={},d="messages/following.json";return a.feedId&&(d="in_group"),b.query=function(a){return new Promise(function(b,e){c.Utils.Yammer.checkLogin().then(function(f){f?yam.platform.request({url:d,method:"GET",data:a?a:null,success:function(a){a=c.Utils.Yammer.formatFeedResponse(a),b(a)},error:function(a){e(a)}}):b(!1)})})},b},c.Yam.Search=function(){var a={},b="search.json";return a.query=function(a,d){return new Promise(function(d,e){c.Utils.Yammer.checkLogin().then(function(f){f?yam.platform.request({url:b,method:"GET",data:a?a:null,success:function(b){b=c.Utils.Yammer.formatSearchResponse(b),c.Utils.Storage.set("SPOC-yam-search-"+JSON.stringify(a),b),d(b)},error:function(a){e(a)}}):d(!1)})})},a},c.Yam.User.prototype.Subscriptions=function(){var a=this,b={};return b.query=function(b,d){return new Promise(function(d,e){c.Utils.Yammer.checkLogin().then(function(f){f?yam.platform.request({url:"subscriptions/to_user/"+a.id+".json",method:"GET",data:b?b:null,success:function(b){c.Utils.Storage.set("SPOC-yam-subs-"+a.id,b),d(b)},error:function(a){e(a)}}):d(!1)})})},b},c.Yam.User.prototype.Profile=function(){var a=this,b={};return b.query=function(b,d){return new Promise(function(d,e){c.Utils.Yammer.checkLogin().then(function(f){f?yam.platform.request({url:"users/"+a.id+".json",method:"GET",data:b?b:null,success:function(b){c.Utils.Storage.set("SPOCC-yam-users-"+a.id,b),d(b)},error:function(a){e(a)}}):d(!1)})})},b}}(window,document,window.SPOC=window.SPOC||{});